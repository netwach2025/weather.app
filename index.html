<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>NetWatch Weather</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  
  <style>
    /* ========== BASE ========== */
    :root {
      --wx-bg-top: #274690;
      --wx-bg-bottom: #020617;
      --wx-text-main: #f8fafc;
      --wx-text-soft: #94a3b8;
      --wx-accent: #f97316;
    }

    *, *::before, *::after { box-sizing: border-box; }

    body {
      margin: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      color: var(--wx-text-main);
      background: 
        radial-gradient(circle at top, var(--wx-bg-top) 0%, rgba(17, 24, 39, 0.8) 50%, var(--wx-bg-bottom) 100%),
        url('boom.png') no-repeat center center fixed;
      background-size: cover;
      background-blend-mode: overlay; 
      transition: background-color 1.5s ease;
    }

    .wx-app {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    /* ========== HEADER ========== */
    .wx-header {
      position: absolute;
      top: 0; left: 0; right: 0;
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 20;
    }

    .wx-chip, .wx-unit-toggle {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(18px) saturate(160%);
      -webkit-backdrop-filter: blur(18px) saturate(160%);
      box-shadow: 0 4px 12px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.3);
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
    }
    
    .wx-chip { padding: 0.5rem 1rem; color: var(--wx-text-main); font-size: 0.85rem; cursor: pointer; gap: 0.5rem; transition: background 0.2s; }
    .wx-chip:hover { background: rgba(255, 255, 255, 0.15); }

    .wx-unit-toggle { padding: 3px; }
    .wx-unit-toggle button {
      border: none; background: transparent; color: var(--wx-text-soft);
      font-size: 0.8rem; padding: 4px 12px; border-radius: 999px;
      cursor: pointer; font-weight: 600; transition: all 0.2s;
    }
    .wx-unit-toggle button.active {
      background: rgba(255, 255, 255, 0.15); color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    /* ========== MAIN LAYOUT ========== */
    .wx-main {
      flex: 1;
      padding-top: 5rem;
      padding-inline: 1rem;
      padding-bottom: 2rem;
      overflow-y: auto;
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    /* ========== HERO ========== */
    .wx-hero {
      position: relative;
      border-radius: 32px;
      overflow: hidden;
      padding: 1.5rem; /* Reduced padding to fit orbs better */
      background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 40%, rgba(255,255,255,0.02) 100%);
      backdrop-filter: blur(30px) saturate(160%);
      -webkit-backdrop-filter: blur(30px) saturate(160%);
      border: 1px solid rgba(255,255,255,0.25);
      box-shadow: 0 20px 60px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.4);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 380px;
    }

    .wx-hero-bg {
      position: absolute; inset: 0;
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.1), transparent 70%);
      opacity: 0.6; z-index: 1; 
      animation: wx-bg-move 20s ease-in-out infinite alternate;
      pointer-events: none;
    }
    @keyframes wx-bg-move {
      0% { transform: scale(1) translate(0, 0); }
      100% { transform: scale(1.1) translate(2%, -1%); }
    }

    .wx-hero-content {
      position: relative; z-index: 2;
      display: flex; flex-direction: column;
      align-items: center; text-align: center;
      width: 100%;
      gap: 0.2rem; /* Tighter gap */
    }

    .wx-hero-location { font-size: 1.3rem; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin-bottom: 0.5rem; }
    
    .wx-hero-condition { 
      display: flex; align-items: center; gap: 0.5rem; 
      font-size: 1rem; color: var(--wx-text-soft); 
      background: rgba(0,0,0,0.3); padding: 0.3rem 0.8rem;
      border-radius: 99px; backdrop-filter: blur(4px);
    }
    .wx-icon-hero { width: 24px; height: 24px; object-fit: contain; }

    .wx-hero-temp {
      font-size: 5.5rem; font-weight: 200; line-height: 1;
      letter-spacing: -3px; text-shadow: 0 4px 12px rgba(0,0,0,0.3);
      margin: 0.5rem 0;
    }

    .wx-hero-meta {
      display: flex; gap: 1rem; font-size: 0.9rem;
      color: var(--wx-text-soft); margin-bottom: 1.5rem;
    }

    /* ========== INTERACTIVE GLASS ORBS ========== */
    .wx-orb-row {
      display: flex;
      gap: 12px;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      width: 100%;
      margin-top: 0.5rem;
      perspective: 1000px; /* Essential for 3D flip */
    }

    /* Container for the flip effect */
    .wx-orb-container {
      width: 110px;
      height: 110px;
      position: relative;
      cursor: pointer;
      border-radius: 50%;
    }

    /* The flipper wrapper */
    .wx-orb-flipper {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1);
      border-radius: 50%;
    }

    /* Trigger flip on class add */
    .wx-orb-container.flipped .wx-orb-flipper {
      transform: rotateY(-180deg); /* Spin to right */
    }

    /* Shared style for Front and Back faces */
    .wx-orb-face {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      backface-visibility: hidden; /* Hides the back when facing away */
      -webkit-backface-visibility: hidden;
      
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;

      /* Glass Style */
      background: radial-gradient(circle at 30% 25%, rgba(255,255,255,0.2), rgba(255,255,255,0.05) 60%);
      border: 1px solid rgba(255,255,255,0.25);
      box-shadow: 0 10px 25px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.3);
      backdrop-filter: blur(12px);
    }

    /* Front Face Specifics */
    .wx-orb-front {
      z-index: 2;
      transform: rotateY(0deg);
    }

    /* Back Face Specifics */
    .wx-orb-back {
      transform: rotateY(-180deg);
      background: radial-gradient(circle at 30% 25%, rgba(15, 23, 42, 0.6), rgba(15, 23, 42, 0.8)); /* Darker for contrast */
      z-index: 1;
    }

    /* Orb Content Styling */
    .wx-orb-icon { font-size: 1.2rem; color: rgba(255,255,255,0.9); margin-bottom: 4px; }
    .wx-orb-value { font-weight: 800; font-size: 1.3rem; color: #fff; line-height: 1; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
    .wx-orb-label { font-size: 0.65rem; letter-spacing: 1px; text-transform: uppercase; color: var(--wx-accent); margin-top: 2px; }
    
    /* Back content specific */
    .wx-orb-detail-icon { font-size: 2rem; color: var(--wx-text-main); margin-bottom: 5px; }
    .wx-orb-detail-text { font-size: 0.8rem; color: var(--wx-text-soft); font-weight: 500; }

    /* Animation for Windmill */
    .spin-slow { animation: spin 2s linear infinite; }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* Decorative sheen lines */
    .wx-orb-lines {
      position: absolute; inset: 0; pointer-events: none; opacity: 0.5;
    }
    .wx-orb-lines span {
      position: absolute; left: 15%; right: 15%; height: 1px;
      background: rgba(255,255,255,0.4);
      animation: scan 3s linear infinite; opacity: 0;
    }
    .wx-orb-lines span:nth-child(1) { top: 30%; animation-delay: 0s; }
    .wx-orb-lines span:nth-child(2) { top: 50%; animation-delay: 1s; }
    .wx-orb-lines span:nth-child(3) { top: 70%; animation-delay: 2s; }

    @keyframes scan {
      0% { opacity: 0; transform: scaleX(0); }
      50% { opacity: 1; transform: scaleX(1); }
      100% { opacity: 0; transform: scaleX(0); }
    }

    /* ========== GRID CARDS ========== */
    .wx-grid { display: flex; flex-direction: column; gap: 1rem; }
    
    .wx-card {
      background: linear-gradient(145deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04));
      border-radius: 24px; padding: 1.2rem;
      border: 1px solid rgba(255,255,255,0.18);
      backdrop-filter: blur(24px) saturate(180%);
      box-shadow: 0 8px 32px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.25);
    }
    .wx-card-header { display: flex; align-items: center; gap: 0.6rem; margin-bottom: 1rem; color: var(--wx-text-soft); font-size: 0.9rem; text-transform: uppercase; font-weight: 600; }

    .wx-hourly-list { display: flex; gap: 1rem; overflow-x: auto; padding-bottom: 0.5rem; scrollbar-width: none; }
    .wx-hourly-item { min-width: 60px; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; background: rgba(255,255,255,0.05); padding: 0.8rem 0.5rem; border-radius: 16px; }
    .wx-daily-row { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0.8rem; background: rgba(255,255,255,0.03); border-radius: 12px; margin-bottom: 0.5rem; }
    
    /* Radar & Barometer Placeholders */
    .wx-radar-body { height: 150px; background: rgba(0,0,0,0.2); border-radius: 16px; display:flex; align-items:center; justify-content:center; border: 1px dashed rgba(255,255,255,0.2); }
    .wx-barometer { display: flex; justify-content: center; height: 100px; align-items: center; }

    /* Responsive */
    @media (min-width: 900px) {
      .wx-main { padding-inline: 15%; }
      .wx-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
      .wx-card-hourly { grid-column: span 3; }
      .wx-card-daily { grid-column: span 1; grid-row: span 2; }
      .wx-card-radar { grid-column: span 2; }
      .wx-card-barometer { grid-column: span 2; }
    }
  </style>
</head>

<body>
  <div class="wx-app">
    <header class="wx-header">
      <button id="wx-locate" class="wx-chip"><i class="ph-bold ph-map-pin"></i><span>Locate</span></button>
      <div class="wx-unit-toggle">
        <button id="wx-unit-f" class="active">°F</button>
        <button id="wx-unit-c">°C</button>
      </div>
    </header>

    <main class="wx-main">
      <section class="wx-hero">
        <div class="wx-hero-bg"></div>
        
        <div class="wx-hero-content">
          <div class="wx-hero-location" id="wx-location">Locating...</div>
          
          <div class="wx-hero-condition">
            <div id="wx-condition-icon-container"><i class="ph-fill ph-circle-notch spin-slow"></i></div>
            <span id="wx-condition-text">...</span>
          </div>

          <div class="wx-hero-temp" id="wx-current-temp">--°</div>

          <div class="wx-hero-meta">
            <span id="wx-feels-like">Feels --°</span>
            <span>•</span>
            <span id="wx-hi-lo">H:-- L:--</span>
          </div>

          <div class="wx-orb-row">
            
            <div class="wx-orb-container" onclick="this.classList.toggle('flipped')">
              <div class="wx-orb-flipper">
                <div class="wx-orb-face wx-orb-front">
                   <div class="wx-orb-lines"><span></span><span></span><span></span></div>
                   <i class="ph-fill ph-wind wx-orb-icon"></i>
                   <div class="wx-orb-value" id="orb-wind-val">--</div>
                   <div class="wx-orb-label">WIND</div>
                </div>
                <div class="wx-orb-face wx-orb-back">
                   <i class="ph-fill ph-fan wx-orb-detail-icon spin-slow"></i>
                   <div class="wx-orb-detail-text">Gusts</div>
                   <div class="wx-orb-value" style="font-size:1rem" id="orb-wind-gust">--</div>
                </div>
              </div>
            </div>

            <div class="wx-orb-container" onclick="this.classList.toggle('flipped')">
              <div class="wx-orb-flipper">
                <div class="wx-orb-face wx-orb-front">
                   <div class="wx-orb-lines"><span></span><span></span><span></span></div>
                   <i class="ph-fill ph-gauge wx-orb-icon"></i>
                   <div class="wx-orb-value" id="orb-pres-val">--</div>
                   <div class="wx-orb-label">hPa</div>
                </div>
                <div class="wx-orb-face wx-orb-back">
                   <i class="ph-bold ph-trend-up wx-orb-detail-icon"></i>
                   <div class="wx-orb-detail-text">Stable</div>
                </div>
              </div>
            </div>

            <div class="wx-orb-container" onclick="this.classList.toggle('flipped')">
              <div class="wx-orb-flipper">
                <div class="wx-orb-face wx-orb-front">
                   <div class="wx-orb-lines"><span></span><span></span><span></span></div>
                   <i class="ph-fill ph-sun wx-orb-icon"></i>
                   <div class="wx-orb-value" id="orb-sun-val">--</div>
                   <div class="wx-orb-label">SUNSET</div>
                </div>
                <div class="wx-orb-face wx-orb-back">
                   <i class="ph-fill ph-horizon wx-orb-detail-icon"></i>
                   <div class="wx-orb-detail-text">Dusk</div>
                   <div class="wx-orb-value" style="font-size:1rem" id="orb-sun-time">--:--</div>
                </div>
              </div>
            </div>

            <div class="wx-orb-container" onclick="this.classList.toggle('flipped')">
              <div class="wx-orb-flipper">
                <div class="wx-orb-face wx-orb-front">
                   <div class="wx-orb-lines"><span></span><span></span><span></span></div>
                   <i class="ph-fill ph-moon-stars wx-orb-icon"></i>
                   <div class="wx-orb-value" id="orb-moon-val">--</div>
                   <div class="wx-orb-label">ILLUM</div>
                </div>
                <div class="wx-orb-face wx-orb-back">
                   <i class="ph-fill ph-moon wx-orb-detail-icon"></i>
                   <div class="wx-orb-detail-text">Phase</div>
                </div>
              </div>
            </div>

          </div> </div>
      </section>

      <section class="wx-grid">
        <article class="wx-card wx-card-hourly">
          <header class="wx-card-header"><i class="ph-bold ph-clock"></i> Next 24 Hours</header>
          <div id="wx-hourly" class="wx-hourly-list"></div>
        </article>
        
        <article class="wx-card wx-card-daily">
          <header class="wx-card-header"><i class="ph-bold ph-calendar-blank"></i> 7-Day</header>
          <div id="wx-daily" class="wx-daily-list"></div>
        </article>

        <article class="wx-card wx-card-radar">
           <header class="wx-card-header"><i class="ph-bold ph-radar"></i> Radar</header>
           <div class="wx-radar-body"><a href="https://windy.com" target="_blank" style="color:white;text-decoration:none">Tap to View Map <i class="ph-bold ph-arrow-square-out"></i></a></div>
        </article>
      </section>
    </main>
  </div>

  <script>
    // --- SIMPLE LOGIC (No changes needed here for visual fix) ---
    let wxUnit = "F"; 
    
    // UI References
    const el = (id) => document.getElementById(id);
    const ui = {
      loc: el('wx-location'), cond: el('wx-condition-text'), icon: el('wx-condition-icon-container'),
      temp: el('wx-current-temp'), feels: el('wx-feels-like'), hilo: el('wx-hi-lo'),
      hourly: el('wx-hourly'), daily: el('wx-daily'),
      // Orbs
      wind: el('orb-wind-val'), gust: el('orb-wind-gust'),
      pres: el('orb-pres-val'),
      sun: el('orb-sun-val'), sunTime: el('orb-sun-time'),
      moon: el('orb-moon-val')
    };

    function getTemp(c) { return wxUnit === "F" ? Math.round((c*9)/5+32) : Math.round(c); }
    
    // Quick Icon Mapper
    function getIcon(code, isDay) {
        const path = "https://raw.githubusercontent.com/basmilius/weather-icons/master/production/fill/svg/";
        // Using generic mapping for demo
        let file = "cloudy.svg";
        if(code === 0) file = isDay ? "clear-day.svg" : "clear-night.svg";
        else if(code < 3) file = isDay ? "partly-cloudy-day.svg" : "partly-cloudy-night.svg";
        else if(code > 50) file = "rain.svg";
        return path + file;
    }

    async function loadWeather() {
      // Hardcoded NY for demo stability, swap with your Geo logic
      const url = "https://api.open-meteo.com/v1/forecast?latitude=40.71&longitude=-74.01&current_weather=true&hourly=temperature_2m,weathercode,surface_pressure&daily=weathercode,temperature_2m_max,temperature_2m_min,sunrise,sunset&windspeed_unit=mph&timezone=auto";
      
      try {
        const res = await fetch(url);
        const data = await res.json();
        const curr = data.current_weather;
        
        ui.loc.textContent = "New York, USA";
        ui.cond.textContent = "Clear Sky"; // Simplified
        ui.icon.innerHTML = `<img src="${getIcon(curr.weathercode, curr.is_day)}" class="wx-icon-hero">`;
        ui.temp.textContent = getTemp(curr.temperature) + "°";
        
        // Populate Orbs
        ui.wind.textContent = Math.round(curr.windspeed);
        ui.gust.textContent = Math.round(curr.windspeed * 1.5); // Mock gust
        ui.pres.textContent = Math.round(data.hourly.surface_pressure[0]);
        
        // Sunset Math
        const sunsetDate = new Date(data.daily.sunset[0]);
        const now = new Date();
        const diffMin = Math.max(0, Math.round((sunsetDate - now)/60000));
        ui.sun.textContent = diffMin + "m";
        ui.sunTime.textContent = sunsetDate.getHours() + ":" + String(sunsetDate.getMinutes()).padStart(2,'0');

        ui.moon.textContent = "84%"; // Mock

        // Populate Lists (Simplified)
        ui.hourly.innerHTML = data.hourly.time.slice(0,12).map((t,i) => `
            <div class="wx-hourly-item">
                <span>${t.slice(11,13)}</span>
                <strong>${getTemp(data.hourly.temperature_2m[i])}°</strong>
            </div>
        `).join('');

        ui.daily.innerHTML = data.daily.time.slice(0,5).map((t,i) => `
            <div class="wx-daily-row">
                <span>${new Date(t).toLocaleDateString('en-US',{weekday:'short'})}</span>
                <div>
                   <b>${getTemp(data.daily.temperature_2m_max[i])}°</b> 
                   <span style="opacity:0.6">${getTemp(data.daily.temperature_2m_min[i])}°</span>
                </div>
            </div>
        `).join('');

      } catch(e) { console.error(e); }
    }

    el('wx-unit-f').onclick = () => { wxUnit="F"; loadWeather(); el('wx-unit-f').classList.add('active'); el('wx-unit-c').classList.remove('active'); };
    el('wx-unit-c').onclick = () => { wxUnit="C"; loadWeather(); el('wx-unit-c').classList.add('active'); el('wx-unit-f').classList.remove('active'); };

    loadWeather();
  </script>
</body>
</html>